ARM GAS  /var/folders/vc/p32jbmgs3k17njj5gy_2_k3w0000gn/T//ccQKnf9p.s 			page 1


   1              		.cpu cortex-m3
   2              		.eabi_attribute 20, 1
   3              		.eabi_attribute 21, 1
   4              		.eabi_attribute 23, 3
   5              		.eabi_attribute 24, 1
   6              		.eabi_attribute 25, 1
   7              		.eabi_attribute 26, 1
   8              		.eabi_attribute 30, 1
   9              		.eabi_attribute 34, 1
  10              		.eabi_attribute 18, 4
  11              		.file	"bsp_f1xx_uart.c"
  12              		.text
  13              	.Ltext0:
  14              		.cfi_sections	.debug_frame
  15              		.global	__aeabi_ui2f
  16              		.global	__aeabi_fdiv
  17              		.global	__aeabi_f2uiz
  18              		.global	__aeabi_i2f
  19              		.global	__aeabi_fsub
  20              		.global	__aeabi_fmul
  21              		.section	.text.bsp_UartInit,"ax",%progbits
  22              		.align	1
  23              		.global	bsp_UartInit
  24              		.syntax unified
  25              		.thumb
  26              		.thumb_func
  27              		.fpu softvfp
  29              	bsp_UartInit:
  30              	.LFB70:
  31              		.file 1 "drivers/bsp_f1xx_uart.c"
   1:drivers/bsp_f1xx_uart.c **** //
   2:drivers/bsp_f1xx_uart.c **** // Created by 周洋 on 2020/3/29.
   3:drivers/bsp_f1xx_uart.c **** //
   4:drivers/bsp_f1xx_uart.c **** 
   5:drivers/bsp_f1xx_uart.c **** #include "bsp_f1xx_uart.h"
   6:drivers/bsp_f1xx_uart.c **** #include "bsp_f1xx_dma.h"
   7:drivers/bsp_f1xx_uart.c **** 
   8:drivers/bsp_f1xx_uart.c **** void Com1SendData(u8 *dat,u16 len);
   9:drivers/bsp_f1xx_uart.c **** void Com2SendData(u8 *dat,u16 len);
  10:drivers/bsp_f1xx_uart.c **** 
  11:drivers/bsp_f1xx_uart.c **** typedef void(*SendFunc)(u8 *dat,u16 len);
  12:drivers/bsp_f1xx_uart.c **** SendFunc SendFuncs[] = {Com1SendData,Com2SendData};
  13:drivers/bsp_f1xx_uart.c **** 
  14:drivers/bsp_f1xx_uart.c **** _uart uartlist[] = {
  15:drivers/bsp_f1xx_uart.c ****         {
  16:drivers/bsp_f1xx_uart.c ****                 .pclk = 72000000,
  17:drivers/bsp_f1xx_uart.c ****                 .irqn = USART1_IRQn,
  18:drivers/bsp_f1xx_uart.c ****                 .uartclk = (vu32 *) &RCC->APB2ENR,
  19:drivers/bsp_f1xx_uart.c ****                 .uartclkbit = BIT14,
  20:drivers/bsp_f1xx_uart.c ****                 .uartx = USART1,
  21:drivers/bsp_f1xx_uart.c **** 
  22:drivers/bsp_f1xx_uart.c ****                 .rxch = DMA1_Channel5,
  23:drivers/bsp_f1xx_uart.c ****                 .txch = DMA1_Channel4,
  24:drivers/bsp_f1xx_uart.c ****                 .dmarxirqn = DMA1_Channel5_IRQn,
  25:drivers/bsp_f1xx_uart.c ****                 .dmatxirqn = DMA1_Channel4_IRQn,
  26:drivers/bsp_f1xx_uart.c **** 
  27:drivers/bsp_f1xx_uart.c ****                 .rxio = {PA,10,IO_MODE_IN_FLOAT},
ARM GAS  /var/folders/vc/p32jbmgs3k17njj5gy_2_k3w0000gn/T//ccQKnf9p.s 			page 2


  28:drivers/bsp_f1xx_uart.c ****                 .txio = {PA,9,IO_MODE_OUT_AF_PP_50MHZ},
  29:drivers/bsp_f1xx_uart.c **** //                .rxio = {PB,7,IO_MODE_IN_FLOAT},
  30:drivers/bsp_f1xx_uart.c **** //                .txio = {PB,6,IO_MODE_OUT_AF_PP_50MHZ},
  31:drivers/bsp_f1xx_uart.c ****         },
  32:drivers/bsp_f1xx_uart.c ****         {
  33:drivers/bsp_f1xx_uart.c ****                 .pclk = 36000000,
  34:drivers/bsp_f1xx_uart.c ****                 .irqn = USART2_IRQn,
  35:drivers/bsp_f1xx_uart.c ****                 .uartclk = (vu32 *) &RCC->APB1ENR,
  36:drivers/bsp_f1xx_uart.c ****                 .uartclkbit = BIT17,
  37:drivers/bsp_f1xx_uart.c ****                 .uartx = USART2,
  38:drivers/bsp_f1xx_uart.c **** 
  39:drivers/bsp_f1xx_uart.c ****                 .rxch = DMA1_Channel6,
  40:drivers/bsp_f1xx_uart.c ****                 .txch = DMA1_Channel7,
  41:drivers/bsp_f1xx_uart.c ****                 .dmarxirqn = DMA1_Channel6_IRQn,
  42:drivers/bsp_f1xx_uart.c ****                 .dmatxirqn = DMA1_Channel7_IRQn,
  43:drivers/bsp_f1xx_uart.c **** 
  44:drivers/bsp_f1xx_uart.c ****                 .rxio = {PA,3,IO_MODE_IN_FLOAT},
  45:drivers/bsp_f1xx_uart.c ****                 .txio = {PA,2,IO_MODE_OUT_AF_PP_50MHZ},
  46:drivers/bsp_f1xx_uart.c ****         },
  47:drivers/bsp_f1xx_uart.c ****         {
  48:drivers/bsp_f1xx_uart.c ****                 .pclk = 36000000,
  49:drivers/bsp_f1xx_uart.c ****                 .irqn = USART3_IRQn,
  50:drivers/bsp_f1xx_uart.c ****                 .uartclk = (vu32 *) &RCC->APB1ENR,
  51:drivers/bsp_f1xx_uart.c ****                 .uartclkbit = BIT18,
  52:drivers/bsp_f1xx_uart.c ****                 .uartx = USART3,
  53:drivers/bsp_f1xx_uart.c **** 
  54:drivers/bsp_f1xx_uart.c ****                 .rxch = DMA1_Channel3,
  55:drivers/bsp_f1xx_uart.c ****                 .txch = DMA1_Channel2,
  56:drivers/bsp_f1xx_uart.c ****                 .dmarxirqn = DMA1_Channel3_IRQn,
  57:drivers/bsp_f1xx_uart.c ****                 .dmatxirqn = DMA1_Channel2_IRQn,
  58:drivers/bsp_f1xx_uart.c **** 
  59:drivers/bsp_f1xx_uart.c ****                 .rxio = {PB,11,IO_MODE_IN_FLOAT},
  60:drivers/bsp_f1xx_uart.c ****                 .txio = {PB,10,IO_MODE_OUT_AF_PP_50MHZ},
  61:drivers/bsp_f1xx_uart.c ****         }
  62:drivers/bsp_f1xx_uart.c **** };
  63:drivers/bsp_f1xx_uart.c **** 
  64:drivers/bsp_f1xx_uart.c **** static inline void *uartmalloc(u32 size)
  65:drivers/bsp_f1xx_uart.c **** {
  66:drivers/bsp_f1xx_uart.c ****     return mymalloc(size);
  67:drivers/bsp_f1xx_uart.c **** }
  68:drivers/bsp_f1xx_uart.c **** 
  69:drivers/bsp_f1xx_uart.c **** static inline void uartfree(void *buf)
  70:drivers/bsp_f1xx_uart.c **** {
  71:drivers/bsp_f1xx_uart.c ****     myfree(buf);
  72:drivers/bsp_f1xx_uart.c **** }
  73:drivers/bsp_f1xx_uart.c **** 
  74:drivers/bsp_f1xx_uart.c **** static inline void InitComBuf(_uart *comx, u16 rxLen, u16 txLen)
  75:drivers/bsp_f1xx_uart.c **** {
  76:drivers/bsp_f1xx_uart.c ****     uartfree(comx->txbuf);
  77:drivers/bsp_f1xx_uart.c ****     uartfree(comx->rxbuf1);
  78:drivers/bsp_f1xx_uart.c ****     uartfree(comx->rxbuf2);
  79:drivers/bsp_f1xx_uart.c **** 
  80:drivers/bsp_f1xx_uart.c ****     comx->txbuf = uartmalloc(txLen);
  81:drivers/bsp_f1xx_uart.c ****     comx->rxbuf1 = uartmalloc(rxLen);
  82:drivers/bsp_f1xx_uart.c ****     comx->rxbuf2 = uartmalloc(rxLen);
  83:drivers/bsp_f1xx_uart.c ****     comx->rxbufLen = rxLen;
  84:drivers/bsp_f1xx_uart.c ****     comx->curbuf = comx->rxbuf1;
ARM GAS  /var/folders/vc/p32jbmgs3k17njj5gy_2_k3w0000gn/T//ccQKnf9p.s 			page 3


  85:drivers/bsp_f1xx_uart.c **** }
  86:drivers/bsp_f1xx_uart.c **** 
  87:drivers/bsp_f1xx_uart.c **** static inline u32 GetBaudDiv(u32 pclk, u32 baud)
  88:drivers/bsp_f1xx_uart.c **** {
  89:drivers/bsp_f1xx_uart.c ****     float temp;
  90:drivers/bsp_f1xx_uart.c ****     u16 mantissa;
  91:drivers/bsp_f1xx_uart.c ****     u16 fraction;
  92:drivers/bsp_f1xx_uart.c ****     temp = ((float)(pclk)) / (baud << 4); //得到USARTDIV
  93:drivers/bsp_f1xx_uart.c ****     mantissa = temp;		      //得到整数部分
  94:drivers/bsp_f1xx_uart.c ****     fraction = (temp - mantissa) * 16;    //得到小数部分
  95:drivers/bsp_f1xx_uart.c ****     mantissa <<= 4;
  96:drivers/bsp_f1xx_uart.c ****     mantissa += fraction;
  97:drivers/bsp_f1xx_uart.c ****     return mantissa;
  98:drivers/bsp_f1xx_uart.c **** }
  99:drivers/bsp_f1xx_uart.c **** 
 100:drivers/bsp_f1xx_uart.c **** /*
 101:drivers/bsp_f1xx_uart.c **** ---------------------------------------------------------------------------------------------------
 102:drivers/bsp_f1xx_uart.c **** * 功    能：初始化串口
 103:drivers/bsp_f1xx_uart.c **** * 输    入：para：串口初始化参数
 104:drivers/bsp_f1xx_uart.c **** * 输    出：无
 105:drivers/bsp_f1xx_uart.c **** ---------------------------------------------------------------------------------------------------
 106:drivers/bsp_f1xx_uart.c **** */
 107:drivers/bsp_f1xx_uart.c **** _DataUtil* bsp_UartInit(_uartpara *para)
 108:drivers/bsp_f1xx_uart.c **** {
  32              		.loc 1 108 0
  33              		.cfi_startproc
  34              		@ args = 0, pretend = 0, frame = 0
  35              		@ frame_needed = 0, uses_anonymous_args = 0
  36              	.LVL0:
  37 0000 2DE9F84F 		push	{r3, r4, r5, r6, r7, r8, r9, r10, fp, lr}
  38              	.LCFI0:
  39              		.cfi_def_cfa_offset 40
  40              		.cfi_offset 3, -40
  41              		.cfi_offset 4, -36
  42              		.cfi_offset 5, -32
  43              		.cfi_offset 6, -28
  44              		.cfi_offset 7, -24
  45              		.cfi_offset 8, -20
  46              		.cfi_offset 9, -16
  47              		.cfi_offset 10, -12
  48              		.cfi_offset 11, -8
  49              		.cfi_offset 14, -4
  50 0004 0546     		mov	r5, r0
 109:drivers/bsp_f1xx_uart.c ****     _DataUtil *util;
 110:drivers/bsp_f1xx_uart.c ****     _uart *cfguart = &uartlist[para->comx-1];
  51              		.loc 1 110 0
  52 0006 0778     		ldrb	r7, [r0]	@ zero_extendqisi2
  53 0008 07F1FF38 		add	r8, r7, #-1
  54 000c 534E     		ldr	r6, .L3
  55 000e 4FEA0817 		lsl	r7, r8, #4
  56 0012 07EB0803 		add	r3, r7, r8
  57 0016 4FEA8309 		lsl	r9, r3, #2
  58 001a 06EB0904 		add	r4, r6, r9
  59              	.LVL1:
 111:drivers/bsp_f1xx_uart.c **** 
 112:drivers/bsp_f1xx_uart.c ****     cfguart->onDataRecved = para->recver;
  60              		.loc 1 112 0
ARM GAS  /var/folders/vc/p32jbmgs3k17njj5gy_2_k3w0000gn/T//ccQKnf9p.s 			page 4


  61 001e C368     		ldr	r3, [r0, #12]
  62 0020 2364     		str	r3, [r4, #64]
 113:drivers/bsp_f1xx_uart.c ****     InitComBuf(cfguart,para->rxbuflen,para->txbuflen);
  63              		.loc 1 113 0
  64 0022 B0F808A0 		ldrh	r10, [r0, #8]
  65 0026 B0F80AB0 		ldrh	fp, [r0, #10]
  66              	.LVL2:
  67              	.LBB44:
  68              	.LBB45:
  69              	.LBB46:
  70              	.LBB47:
  71:drivers/bsp_f1xx_uart.c **** }
  71              		.loc 1 71 0
  72 002a 6069     		ldr	r0, [r4, #20]
  73              	.LVL3:
  74 002c FFF7FEFF 		bl	myfree
  75              	.LVL4:
  76              	.LBE47:
  77              	.LBE46:
  78              	.LBB48:
  79              	.LBB49:
  80 0030 E068     		ldr	r0, [r4, #12]
  81 0032 FFF7FEFF 		bl	myfree
  82              	.LVL5:
  83              	.LBE49:
  84              	.LBE48:
  85              	.LBB50:
  86              	.LBB51:
  87 0036 2069     		ldr	r0, [r4, #16]
  88 0038 FFF7FEFF 		bl	myfree
  89              	.LVL6:
  90              	.LBE51:
  91              	.LBE50:
  92              	.LBB52:
  93              	.LBB53:
  66:drivers/bsp_f1xx_uart.c **** }
  94              		.loc 1 66 0
  95 003c 5846     		mov	r0, fp
  96 003e FFF7FEFF 		bl	mymalloc
  97              	.LVL7:
  98              	.LBE53:
  99              	.LBE52:
  80:drivers/bsp_f1xx_uart.c ****     comx->rxbuf1 = uartmalloc(rxLen);
 100              		.loc 1 80 0
 101 0042 6061     		str	r0, [r4, #20]
 102              	.LVL8:
 103              	.LBB54:
 104              	.LBB55:
  66:drivers/bsp_f1xx_uart.c **** }
 105              		.loc 1 66 0
 106 0044 5046     		mov	r0, r10
 107 0046 FFF7FEFF 		bl	mymalloc
 108              	.LVL9:
 109              	.LBE55:
 110              	.LBE54:
  81:drivers/bsp_f1xx_uart.c ****     comx->rxbuf2 = uartmalloc(rxLen);
 111              		.loc 1 81 0
ARM GAS  /var/folders/vc/p32jbmgs3k17njj5gy_2_k3w0000gn/T//ccQKnf9p.s 			page 5


 112 004a E060     		str	r0, [r4, #12]
 113              	.LVL10:
 114              	.LBB56:
 115              	.LBB57:
  66:drivers/bsp_f1xx_uart.c **** }
 116              		.loc 1 66 0
 117 004c 5046     		mov	r0, r10
 118 004e FFF7FEFF 		bl	mymalloc
 119              	.LVL11:
 120              	.LBE57:
 121              	.LBE56:
  82:drivers/bsp_f1xx_uart.c ****     comx->rxbufLen = rxLen;
 122              		.loc 1 82 0
 123 0052 2061     		str	r0, [r4, #16]
  83:drivers/bsp_f1xx_uart.c ****     comx->curbuf = comx->rxbuf1;
 124              		.loc 1 83 0
 125 0054 A4F806A0 		strh	r10, [r4, #6]	@ movhi
  84:drivers/bsp_f1xx_uart.c **** }
 126              		.loc 1 84 0
 127 0058 E368     		ldr	r3, [r4, #12]
 128 005a A360     		str	r3, [r4, #8]
 129              	.LVL12:
 130              	.LBE45:
 131              	.LBE44:
 114:drivers/bsp_f1xx_uart.c **** 
 115:drivers/bsp_f1xx_uart.c ****     dmainit(cfguart->rxch,(u32)&cfguart->uartx->DR,(u32)&cfguart->rxbuf1[0],0);
 132              		.loc 1 115 0
 133 005c 216A     		ldr	r1, [r4, #32]
 134 005e 0023     		movs	r3, #0
 135 0060 E268     		ldr	r2, [r4, #12]
 136 0062 0431     		adds	r1, r1, #4
 137 0064 A06A     		ldr	r0, [r4, #40]
 138 0066 FFF7FEFF 		bl	dmainit
 139              	.LVL13:
 116:drivers/bsp_f1xx_uart.c ****     dmainit(cfguart->txch,(u32)&cfguart->uartx->DR,(u32)&cfguart->txbuf[0],1);
 140              		.loc 1 116 0
 141 006a 216A     		ldr	r1, [r4, #32]
 142 006c 0123     		movs	r3, #1
 143 006e 6269     		ldr	r2, [r4, #20]
 144 0070 0431     		adds	r1, r1, #4
 145 0072 E06A     		ldr	r0, [r4, #44]
 146 0074 FFF7FEFF 		bl	dmainit
 147              	.LVL14:
 117:drivers/bsp_f1xx_uart.c ****     bsp_IoInit(&cfguart->txio);
 148              		.loc 1 117 0
 149 0078 4846     		mov	r0, r9
 150 007a 3030     		adds	r0, r0, #48
 151 007c 3044     		add	r0, r0, r6
 152 007e FFF7FEFF 		bl	bsp_IoInit
 153              	.LVL15:
 118:drivers/bsp_f1xx_uart.c ****     bsp_IoInit(&cfguart->rxio);
 154              		.loc 1 118 0
 155 0082 4846     		mov	r0, r9
 156 0084 3830     		adds	r0, r0, #56
 157 0086 3044     		add	r0, r0, r6
 158 0088 FFF7FEFF 		bl	bsp_IoInit
 159              	.LVL16:
ARM GAS  /var/folders/vc/p32jbmgs3k17njj5gy_2_k3w0000gn/T//ccQKnf9p.s 			page 6


 119:drivers/bsp_f1xx_uart.c **** //    RCC->APB2ENR |= BIT0; //AFIO时钟
 120:drivers/bsp_f1xx_uart.c **** //    AFIO->MAPR |= BIT2;   //串口1重映射到PB6、PB7
 121:drivers/bsp_f1xx_uart.c **** 
 122:drivers/bsp_f1xx_uart.c ****     *cfguart->uartclk |= cfguart->uartclkbit;
 160              		.loc 1 122 0
 161 008c A269     		ldr	r2, [r4, #24]
 162 008e 1368     		ldr	r3, [r2]
 163 0090 E169     		ldr	r1, [r4, #28]
 164 0092 0B43     		orrs	r3, r3, r1
 165 0094 1360     		str	r3, [r2]
 123:drivers/bsp_f1xx_uart.c ****     delay_ms(100);
 166              		.loc 1 123 0
 167 0096 6420     		movs	r0, #100
 168 0098 FFF7FEFF 		bl	delay_ms
 169              	.LVL17:
 124:drivers/bsp_f1xx_uart.c ****     cfguart->uartx->BRR = GetBaudDiv(cfguart->pclk, para->baud); // 波特率设置
 170              		.loc 1 124 0
 171 009c D5F804B0 		ldr	fp, [r5, #4]
 172 00a0 D4F820A0 		ldr	r10, [r4, #32]
 173              	.LVL18:
 174              	.LBB58:
 175              	.LBB59:
  92:drivers/bsp_f1xx_uart.c ****     mantissa = temp;		      //得到整数部分
 176              		.loc 1 92 0
 177 00a4 56F80900 		ldr	r0, [r6, r9]
 178 00a8 FFF7FEFF 		bl	__aeabi_ui2f
 179              	.LVL19:
 180 00ac 8146     		mov	r9, r0
 181 00ae 4FEA0B10 		lsl	r0, fp, #4
 182 00b2 FFF7FEFF 		bl	__aeabi_ui2f
 183              	.LVL20:
 184 00b6 0146     		mov	r1, r0
 185 00b8 4846     		mov	r0, r9
 186 00ba FFF7FEFF 		bl	__aeabi_fdiv
 187              	.LVL21:
 188 00be 8346     		mov	fp, r0
 189              	.LVL22:
  93:drivers/bsp_f1xx_uart.c ****     fraction = (temp - mantissa) * 16;    //得到小数部分
 190              		.loc 1 93 0
 191 00c0 FFF7FEFF 		bl	__aeabi_f2uiz
 192              	.LVL23:
 193 00c4 1FFA80F9 		uxth	r9, r0
 194              	.LVL24:
  94:drivers/bsp_f1xx_uart.c ****     mantissa <<= 4;
 195              		.loc 1 94 0
 196 00c8 4846     		mov	r0, r9
 197 00ca FFF7FEFF 		bl	__aeabi_i2f
 198              	.LVL25:
 199 00ce 0146     		mov	r1, r0
 200 00d0 5846     		mov	r0, fp
 201 00d2 FFF7FEFF 		bl	__aeabi_fsub
 202              	.LVL26:
 203 00d6 4FF08341 		mov	r1, #1098907648
 204 00da FFF7FEFF 		bl	__aeabi_fmul
 205              	.LVL27:
 206 00de FFF7FEFF 		bl	__aeabi_f2uiz
 207              	.LVL28:
ARM GAS  /var/folders/vc/p32jbmgs3k17njj5gy_2_k3w0000gn/T//ccQKnf9p.s 			page 7


 208 00e2 80B2     		uxth	r0, r0
 209              	.LVL29:
  95:drivers/bsp_f1xx_uart.c ****     mantissa += fraction;
 210              		.loc 1 95 0
 211 00e4 4FEA0919 		lsl	r9, r9, #4
 212              	.LVL30:
 213 00e8 1FFA89F9 		uxth	r9, r9
 214              	.LVL31:
  96:drivers/bsp_f1xx_uart.c ****     return mantissa;
 215              		.loc 1 96 0
 216 00ec 8144     		add	r9, r9, r0
 217              	.LVL32:
 218 00ee 1FFA89F0 		uxth	r0, r9
 219              	.LVL33:
 220              	.LBE59:
 221              	.LBE58:
 222              		.loc 1 124 0
 223 00f2 CAF80800 		str	r0, [r10, #8]
 125:drivers/bsp_f1xx_uart.c ****     cfguart->uartx->CR3 |= 0xC0;
 224              		.loc 1 125 0
 225 00f6 226A     		ldr	r2, [r4, #32]
 226 00f8 5369     		ldr	r3, [r2, #20]
 227 00fa 43F0C003 		orr	r3, r3, #192
 228 00fe 5361     		str	r3, [r2, #20]
 126:drivers/bsp_f1xx_uart.c ****     cfguart->uartx->CR1 |= 0X200C; //1位停止,无校验位.
 229              		.loc 1 126 0
 230 0100 226A     		ldr	r2, [r4, #32]
 231 0102 D368     		ldr	r3, [r2, #12]
 232 0104 43F40053 		orr	r3, r3, #8192
 233 0108 43F00C03 		orr	r3, r3, #12
 234 010c D360     		str	r3, [r2, #12]
 127:drivers/bsp_f1xx_uart.c ****     //使能空闲中断
 128:drivers/bsp_f1xx_uart.c ****     cfguart->uartx->CR1 |= BIT4;			   //idle中断
 235              		.loc 1 128 0
 236 010e 226A     		ldr	r2, [r4, #32]
 237 0110 D368     		ldr	r3, [r2, #12]
 238 0112 43F01003 		orr	r3, r3, #16
 239 0116 D360     		str	r3, [r2, #12]
 129:drivers/bsp_f1xx_uart.c ****     MY_NVIC_Init(0,para->comx+2,cfguart->irqn,1);//组2，最低优先级
 240              		.loc 1 129 0
 241 0118 2978     		ldrb	r1, [r5]	@ zero_extendqisi2
 242 011a 0231     		adds	r1, r1, #2
 243 011c 0123     		movs	r3, #1
 244 011e 2279     		ldrb	r2, [r4, #4]	@ zero_extendqisi2
 245 0120 C9B2     		uxtb	r1, r1
 246 0122 0020     		movs	r0, #0
 247 0124 FFF7FEFF 		bl	MY_NVIC_Init
 248              	.LVL34:
 130:drivers/bsp_f1xx_uart.c **** 	MY_NVIC_Init(0, para->comx - 1, cfguart->dmarxirqn, 1);
 249              		.loc 1 130 0
 250 0128 2978     		ldrb	r1, [r5]	@ zero_extendqisi2
 251 012a 0139     		subs	r1, r1, #1
 252 012c 0123     		movs	r3, #1
 253 012e 94F82420 		ldrb	r2, [r4, #36]	@ zero_extendqisi2
 254 0132 C9B2     		uxtb	r1, r1
 255 0134 0020     		movs	r0, #0
 256 0136 FFF7FEFF 		bl	MY_NVIC_Init
ARM GAS  /var/folders/vc/p32jbmgs3k17njj5gy_2_k3w0000gn/T//ccQKnf9p.s 			page 8


 257              	.LVL35:
 131:drivers/bsp_f1xx_uart.c ****     dma_stream_en(cfguart->rxch,cfguart->curbuf,cfguart->rxbufLen);
 258              		.loc 1 131 0
 259 013a E288     		ldrh	r2, [r4, #6]
 260 013c A168     		ldr	r1, [r4, #8]
 261 013e A06A     		ldr	r0, [r4, #40]
 262 0140 FFF7FEFF 		bl	dma_stream_en
 263              	.LVL36:
 264              	.LBB60:
 265              	.LBB61:
  66:drivers/bsp_f1xx_uart.c **** }
 266              		.loc 1 66 0
 267 0144 1020     		movs	r0, #16
 268 0146 FFF7FEFF 		bl	mymalloc
 269              	.LVL37:
 270              	.LBE61:
 271              	.LBE60:
 132:drivers/bsp_f1xx_uart.c **** 
 133:drivers/bsp_f1xx_uart.c ****     util = uartmalloc(sizeof(_DataUtil));
 134:drivers/bsp_f1xx_uart.c ****     util->write = SendFuncs[para->comx-1];
 272              		.loc 1 134 0
 273 014a 2B78     		ldrb	r3, [r5]	@ zero_extendqisi2
 274 014c 013B     		subs	r3, r3, #1
 275 014e 0449     		ldr	r1, .L3+4
 276 0150 51F82330 		ldr	r3, [r1, r3, lsl #2]
 277 0154 4360     		str	r3, [r0, #4]
 135:drivers/bsp_f1xx_uart.c ****     util->para = para;
 278              		.loc 1 135 0
 279 0156 0560     		str	r5, [r0]
 136:drivers/bsp_f1xx_uart.c ****     return util;
 137:drivers/bsp_f1xx_uart.c **** }
 280              		.loc 1 137 0
 281 0158 BDE8F88F 		pop	{r3, r4, r5, r6, r7, r8, r9, r10, fp, pc}
 282              	.LVL38:
 283              	.L4:
 284              		.align	2
 285              	.L3:
 286 015c 00000000 		.word	.LANCHOR0
 287 0160 00000000 		.word	.LANCHOR1
 288              		.cfi_endproc
 289              	.LFE70:
 291              		.section	.text.bsp_UartClose,"ax",%progbits
 292              		.align	1
 293              		.global	bsp_UartClose
 294              		.syntax unified
 295              		.thumb
 296              		.thumb_func
 297              		.fpu softvfp
 299              	bsp_UartClose:
 300              	.LFB71:
 138:drivers/bsp_f1xx_uart.c **** 
 139:drivers/bsp_f1xx_uart.c **** void bsp_UartClose(_DataUtil *util)
 140:drivers/bsp_f1xx_uart.c **** {
 301              		.loc 1 140 0
 302              		.cfi_startproc
 303              		@ args = 0, pretend = 0, frame = 0
 304              		@ frame_needed = 0, uses_anonymous_args = 0
ARM GAS  /var/folders/vc/p32jbmgs3k17njj5gy_2_k3w0000gn/T//ccQKnf9p.s 			page 9


 305              	.LVL39:
 306 0000 F8B5     		push	{r3, r4, r5, r6, r7, lr}
 307              	.LCFI1:
 308              		.cfi_def_cfa_offset 24
 309              		.cfi_offset 3, -24
 310              		.cfi_offset 4, -20
 311              		.cfi_offset 5, -16
 312              		.cfi_offset 6, -12
 313              		.cfi_offset 7, -8
 314              		.cfi_offset 14, -4
 141:drivers/bsp_f1xx_uart.c **** 	_uartpara *para = (_uartpara*)util->para;
 315              		.loc 1 141 0
 316 0002 0368     		ldr	r3, [r0]
 317              	.LVL40:
 142:drivers/bsp_f1xx_uart.c **** 	_uart *cfguart = &uartlist[para->comx-1];
 318              		.loc 1 142 0
 319 0004 1D78     		ldrb	r5, [r3]	@ zero_extendqisi2
 320 0006 6E1E     		subs	r6, r5, #1
 321              	.LVL41:
 143:drivers/bsp_f1xx_uart.c **** 	uartfree(cfguart->rxbuf1);
 322              		.loc 1 143 0
 323 0008 094F     		ldr	r7, .L7
 324 000a 3501     		lsls	r5, r6, #4
 325 000c AB19     		adds	r3, r5, r6
 326              	.LVL42:
 327 000e 9C00     		lsls	r4, r3, #2
 328 0010 3C44     		add	r4, r4, r7
 329              	.LVL43:
 330              	.LBB62:
 331              	.LBB63:
  71:drivers/bsp_f1xx_uart.c **** }
 332              		.loc 1 71 0
 333 0012 E068     		ldr	r0, [r4, #12]
 334              	.LVL44:
 335 0014 FFF7FEFF 		bl	myfree
 336              	.LVL45:
 337              	.LBE63:
 338              	.LBE62:
 339              	.LBB64:
 340              	.LBB65:
 341 0018 2069     		ldr	r0, [r4, #16]
 342 001a FFF7FEFF 		bl	myfree
 343              	.LVL46:
 344              	.LBE65:
 345              	.LBE64:
 346              	.LBB66:
 347              	.LBB67:
 348 001e 6069     		ldr	r0, [r4, #20]
 349 0020 FFF7FEFF 		bl	myfree
 350              	.LVL47:
 351              	.LBE67:
 352              	.LBE66:
 144:drivers/bsp_f1xx_uart.c **** 	uartfree(cfguart->rxbuf2);
 145:drivers/bsp_f1xx_uart.c **** 	uartfree(cfguart->txbuf);
 146:drivers/bsp_f1xx_uart.c **** 	cfguart->rxch->CCR &= ~0x01;
 353              		.loc 1 146 0
 354 0024 A26A     		ldr	r2, [r4, #40]
ARM GAS  /var/folders/vc/p32jbmgs3k17njj5gy_2_k3w0000gn/T//ccQKnf9p.s 			page 10


 355 0026 1368     		ldr	r3, [r2]
 356 0028 23F00103 		bic	r3, r3, #1
 357 002c 1360     		str	r3, [r2]
 147:drivers/bsp_f1xx_uart.c **** }
 358              		.loc 1 147 0
 359 002e F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 360              	.LVL48:
 361              	.L8:
 362              		.align	2
 363              	.L7:
 364 0030 00000000 		.word	.LANCHOR0
 365              		.cfi_endproc
 366              	.LFE71:
 368              		.section	.text.USART1_IRQHandler,"ax",%progbits
 369              		.align	1
 370              		.global	USART1_IRQHandler
 371              		.syntax unified
 372              		.thumb
 373              		.thumb_func
 374              		.fpu softvfp
 376              	USART1_IRQHandler:
 377              	.LFB73:
 148:drivers/bsp_f1xx_uart.c **** 
 149:drivers/bsp_f1xx_uart.c **** static inline void OnComDataRecved(u8 comx,u8 isIdle)
 150:drivers/bsp_f1xx_uart.c **** {
 151:drivers/bsp_f1xx_uart.c ****     u8 *p = 0;
 152:drivers/bsp_f1xx_uart.c ****     u16 recvLen = 0;
 153:drivers/bsp_f1xx_uart.c ****     _uart *recvCom = &uartlist[comx - 1];
 154:drivers/bsp_f1xx_uart.c **** 
 155:drivers/bsp_f1xx_uart.c ****     if(isIdle)
 156:drivers/bsp_f1xx_uart.c ****         recvLen = recvCom->rxbufLen - recvCom->rxch->CNDTR;
 157:drivers/bsp_f1xx_uart.c ****     else
 158:drivers/bsp_f1xx_uart.c ****         recvLen = recvCom->rxbufLen;
 159:drivers/bsp_f1xx_uart.c ****     if(recvLen==0)
 160:drivers/bsp_f1xx_uart.c ****     {
 161:drivers/bsp_f1xx_uart.c ****         dma_clear_flag(recvCom->rxch);
 162:drivers/bsp_f1xx_uart.c ****         dma_stream_en(recvCom->rxch,recvCom->curbuf,recvCom->rxbufLen);
 163:drivers/bsp_f1xx_uart.c ****     }
 164:drivers/bsp_f1xx_uart.c **** 
 165:drivers/bsp_f1xx_uart.c ****     p = recvCom->curbuf;
 166:drivers/bsp_f1xx_uart.c ****     if(recvCom->curbuf == recvCom->rxbuf1)
 167:drivers/bsp_f1xx_uart.c ****     {
 168:drivers/bsp_f1xx_uart.c ****         recvCom->curbuf = recvCom->rxbuf2;
 169:drivers/bsp_f1xx_uart.c ****     }else{
 170:drivers/bsp_f1xx_uart.c ****         recvCom->curbuf = recvCom->rxbuf1;
 171:drivers/bsp_f1xx_uart.c ****     }
 172:drivers/bsp_f1xx_uart.c ****     dma_clear_flag(recvCom->rxch);
 173:drivers/bsp_f1xx_uart.c ****     dma_stream_en(recvCom->rxch,recvCom->curbuf,recvCom->rxbufLen);
 174:drivers/bsp_f1xx_uart.c ****     recvCom->onDataRecved(p, recvLen);
 175:drivers/bsp_f1xx_uart.c **** }
 176:drivers/bsp_f1xx_uart.c **** 
 177:drivers/bsp_f1xx_uart.c **** void USART1_IRQHandler(void)
 178:drivers/bsp_f1xx_uart.c **** {
 378              		.loc 1 178 0
 379              		.cfi_startproc
 380              		@ args = 0, pretend = 0, frame = 0
 381              		@ frame_needed = 0, uses_anonymous_args = 0
ARM GAS  /var/folders/vc/p32jbmgs3k17njj5gy_2_k3w0000gn/T//ccQKnf9p.s 			page 11


 179:drivers/bsp_f1xx_uart.c ****     u8 temp = USART1->SR;
 382              		.loc 1 179 0
 383 0000 194B     		ldr	r3, .L21
 384 0002 1B68     		ldr	r3, [r3]
 385              	.LVL49:
 180:drivers/bsp_f1xx_uart.c ****     if (temp & BIT4) //空闲中断
 386              		.loc 1 180 0
 387 0004 13F0100F 		tst	r3, #16
 388 0008 00D1     		bne	.L18
 389 000a 7047     		bx	lr
 390              	.L18:
 178:drivers/bsp_f1xx_uart.c ****     u8 temp = USART1->SR;
 391              		.loc 1 178 0
 392 000c 70B5     		push	{r4, r5, r6, lr}
 393              	.LCFI2:
 394              		.cfi_def_cfa_offset 16
 395              		.cfi_offset 4, -16
 396              		.cfi_offset 5, -12
 397              		.cfi_offset 6, -8
 398              		.cfi_offset 14, -4
 181:drivers/bsp_f1xx_uart.c ****     {
 182:drivers/bsp_f1xx_uart.c ****         temp = USART1->DR;
 399              		.loc 1 182 0
 400 000e 164B     		ldr	r3, .L21
 401              	.LVL50:
 402 0010 5B68     		ldr	r3, [r3, #4]
 403              	.LVL51:
 404              	.LBB70:
 405              	.LBB71:
 156:drivers/bsp_f1xx_uart.c ****     else
 406              		.loc 1 156 0
 407 0012 164B     		ldr	r3, .L21+4
 408 0014 DC88     		ldrh	r4, [r3, #6]
 409 0016 9B6A     		ldr	r3, [r3, #40]
 410 0018 5B68     		ldr	r3, [r3, #4]
 411 001a 9BB2     		uxth	r3, r3
 412 001c E41A     		subs	r4, r4, r3
 413 001e A4B2     		uxth	r4, r4
 414              	.LVL52:
 159:drivers/bsp_f1xx_uart.c ****     {
 415              		.loc 1 159 0
 416 0020 A4B1     		cbz	r4, .L19
 417              	.L11:
 165:drivers/bsp_f1xx_uart.c ****     if(recvCom->curbuf == recvCom->rxbuf1)
 418              		.loc 1 165 0
 419 0022 124B     		ldr	r3, .L21+4
 420 0024 9E68     		ldr	r6, [r3, #8]
 421              	.LVL53:
 166:drivers/bsp_f1xx_uart.c ****     {
 422              		.loc 1 166 0
 423 0026 DB68     		ldr	r3, [r3, #12]
 424 0028 9E42     		cmp	r6, r3
 425 002a 19D0     		beq	.L20
 170:drivers/bsp_f1xx_uart.c ****     }
 426              		.loc 1 170 0
 427 002c 0F4A     		ldr	r2, .L21+4
 428 002e 9360     		str	r3, [r2, #8]
ARM GAS  /var/folders/vc/p32jbmgs3k17njj5gy_2_k3w0000gn/T//ccQKnf9p.s 			page 12


 429              	.L13:
 172:drivers/bsp_f1xx_uart.c ****     dma_stream_en(recvCom->rxch,recvCom->curbuf,recvCom->rxbufLen);
 430              		.loc 1 172 0
 431 0030 0E4D     		ldr	r5, .L21+4
 432 0032 A86A     		ldr	r0, [r5, #40]
 433 0034 FFF7FEFF 		bl	dma_clear_flag
 434              	.LVL54:
 173:drivers/bsp_f1xx_uart.c ****     recvCom->onDataRecved(p, recvLen);
 435              		.loc 1 173 0
 436 0038 EA88     		ldrh	r2, [r5, #6]
 437 003a A968     		ldr	r1, [r5, #8]
 438 003c A86A     		ldr	r0, [r5, #40]
 439 003e FFF7FEFF 		bl	dma_stream_en
 440              	.LVL55:
 174:drivers/bsp_f1xx_uart.c **** }
 441              		.loc 1 174 0
 442 0042 2B6C     		ldr	r3, [r5, #64]
 443 0044 2146     		mov	r1, r4
 444 0046 3046     		mov	r0, r6
 445 0048 9847     		blx	r3
 446              	.LVL56:
 447              	.LBE71:
 448              	.LBE70:
 183:drivers/bsp_f1xx_uart.c ****         OnComDataRecved(COM1,1);
 184:drivers/bsp_f1xx_uart.c ****     }
 185:drivers/bsp_f1xx_uart.c **** }
 449              		.loc 1 185 0
 450 004a 70BD     		pop	{r4, r5, r6, pc}
 451              	.LVL57:
 452              	.L19:
 453              	.LBB73:
 454              	.LBB72:
 161:drivers/bsp_f1xx_uart.c ****         dma_stream_en(recvCom->rxch,recvCom->curbuf,recvCom->rxbufLen);
 455              		.loc 1 161 0
 456 004c 074D     		ldr	r5, .L21+4
 457 004e A86A     		ldr	r0, [r5, #40]
 458 0050 FFF7FEFF 		bl	dma_clear_flag
 459              	.LVL58:
 162:drivers/bsp_f1xx_uart.c ****     }
 460              		.loc 1 162 0
 461 0054 EA88     		ldrh	r2, [r5, #6]
 462 0056 A968     		ldr	r1, [r5, #8]
 463 0058 A86A     		ldr	r0, [r5, #40]
 464 005a FFF7FEFF 		bl	dma_stream_en
 465              	.LVL59:
 466 005e E0E7     		b	.L11
 467              	.LVL60:
 468              	.L20:
 168:drivers/bsp_f1xx_uart.c ****     }else{
 469              		.loc 1 168 0
 470 0060 024B     		ldr	r3, .L21+4
 471 0062 1A69     		ldr	r2, [r3, #16]
 472 0064 9A60     		str	r2, [r3, #8]
 473 0066 E3E7     		b	.L13
 474              	.L22:
 475              		.align	2
 476              	.L21:
ARM GAS  /var/folders/vc/p32jbmgs3k17njj5gy_2_k3w0000gn/T//ccQKnf9p.s 			page 13


 477 0068 00380140 		.word	1073821696
 478 006c 00000000 		.word	.LANCHOR0
 479              	.LBE72:
 480              	.LBE73:
 481              		.cfi_endproc
 482              	.LFE73:
 484              		.section	.text.USART2_IRQHandler,"ax",%progbits
 485              		.align	1
 486              		.global	USART2_IRQHandler
 487              		.syntax unified
 488              		.thumb
 489              		.thumb_func
 490              		.fpu softvfp
 492              	USART2_IRQHandler:
 493              	.LFB74:
 186:drivers/bsp_f1xx_uart.c **** 
 187:drivers/bsp_f1xx_uart.c **** void USART2_IRQHandler(void)
 188:drivers/bsp_f1xx_uart.c **** {
 494              		.loc 1 188 0
 495              		.cfi_startproc
 496              		@ args = 0, pretend = 0, frame = 0
 497              		@ frame_needed = 0, uses_anonymous_args = 0
 189:drivers/bsp_f1xx_uart.c ****     u8 temp = USART2->SR;
 498              		.loc 1 189 0
 499 0000 1B4B     		ldr	r3, .L35
 500 0002 1B68     		ldr	r3, [r3]
 501              	.LVL61:
 190:drivers/bsp_f1xx_uart.c ****     if (temp & BIT4) //空闲中断
 502              		.loc 1 190 0
 503 0004 13F0100F 		tst	r3, #16
 504 0008 00D1     		bne	.L32
 505 000a 7047     		bx	lr
 506              	.L32:
 188:drivers/bsp_f1xx_uart.c ****     u8 temp = USART2->SR;
 507              		.loc 1 188 0
 508 000c 70B5     		push	{r4, r5, r6, lr}
 509              	.LCFI3:
 510              		.cfi_def_cfa_offset 16
 511              		.cfi_offset 4, -16
 512              		.cfi_offset 5, -12
 513              		.cfi_offset 6, -8
 514              		.cfi_offset 14, -4
 191:drivers/bsp_f1xx_uart.c ****     {
 192:drivers/bsp_f1xx_uart.c ****         temp = USART2->DR;
 515              		.loc 1 192 0
 516 000e 184B     		ldr	r3, .L35
 517              	.LVL62:
 518 0010 5B68     		ldr	r3, [r3, #4]
 519              	.LVL63:
 520              	.LBB76:
 521              	.LBB77:
 156:drivers/bsp_f1xx_uart.c ****     else
 522              		.loc 1 156 0
 523 0012 184B     		ldr	r3, .L35+4
 524 0014 B3F84A40 		ldrh	r4, [r3, #74]
 525 0018 DB6E     		ldr	r3, [r3, #108]
 526 001a 5B68     		ldr	r3, [r3, #4]
ARM GAS  /var/folders/vc/p32jbmgs3k17njj5gy_2_k3w0000gn/T//ccQKnf9p.s 			page 14


 527 001c 9BB2     		uxth	r3, r3
 528 001e E41A     		subs	r4, r4, r3
 529 0020 A4B2     		uxth	r4, r4
 530              	.LVL64:
 159:drivers/bsp_f1xx_uart.c ****     {
 531              		.loc 1 159 0
 532 0022 B4B1     		cbz	r4, .L33
 533              	.L25:
 165:drivers/bsp_f1xx_uart.c ****     if(recvCom->curbuf == recvCom->rxbuf1)
 534              		.loc 1 165 0
 535 0024 134B     		ldr	r3, .L35+4
 536 0026 DE6C     		ldr	r6, [r3, #76]
 537              	.LVL65:
 166:drivers/bsp_f1xx_uart.c ****     {
 538              		.loc 1 166 0
 539 0028 1B6D     		ldr	r3, [r3, #80]
 540 002a 9E42     		cmp	r6, r3
 541 002c 1CD0     		beq	.L34
 170:drivers/bsp_f1xx_uart.c ****     }
 542              		.loc 1 170 0
 543 002e 114A     		ldr	r2, .L35+4
 544 0030 D364     		str	r3, [r2, #76]
 545              	.L27:
 172:drivers/bsp_f1xx_uart.c ****     dma_stream_en(recvCom->rxch,recvCom->curbuf,recvCom->rxbufLen);
 546              		.loc 1 172 0
 547 0032 104D     		ldr	r5, .L35+4
 548 0034 E86E     		ldr	r0, [r5, #108]
 549 0036 FFF7FEFF 		bl	dma_clear_flag
 550              	.LVL66:
 173:drivers/bsp_f1xx_uart.c ****     recvCom->onDataRecved(p, recvLen);
 551              		.loc 1 173 0
 552 003a B5F84A20 		ldrh	r2, [r5, #74]
 553 003e E96C     		ldr	r1, [r5, #76]
 554 0040 E86E     		ldr	r0, [r5, #108]
 555 0042 FFF7FEFF 		bl	dma_stream_en
 556              	.LVL67:
 174:drivers/bsp_f1xx_uart.c **** }
 557              		.loc 1 174 0
 558 0046 D5F88430 		ldr	r3, [r5, #132]
 559 004a 2146     		mov	r1, r4
 560 004c 3046     		mov	r0, r6
 561 004e 9847     		blx	r3
 562              	.LVL68:
 563              	.LBE77:
 564              	.LBE76:
 193:drivers/bsp_f1xx_uart.c ****         OnComDataRecved(COM2,1);
 194:drivers/bsp_f1xx_uart.c ****     }
 195:drivers/bsp_f1xx_uart.c **** }
 565              		.loc 1 195 0
 566 0050 70BD     		pop	{r4, r5, r6, pc}
 567              	.LVL69:
 568              	.L33:
 569              	.LBB79:
 570              	.LBB78:
 161:drivers/bsp_f1xx_uart.c ****         dma_stream_en(recvCom->rxch,recvCom->curbuf,recvCom->rxbufLen);
 571              		.loc 1 161 0
 572 0052 084D     		ldr	r5, .L35+4
ARM GAS  /var/folders/vc/p32jbmgs3k17njj5gy_2_k3w0000gn/T//ccQKnf9p.s 			page 15


 573 0054 E86E     		ldr	r0, [r5, #108]
 574 0056 FFF7FEFF 		bl	dma_clear_flag
 575              	.LVL70:
 162:drivers/bsp_f1xx_uart.c ****     }
 576              		.loc 1 162 0
 577 005a B5F84A20 		ldrh	r2, [r5, #74]
 578 005e E96C     		ldr	r1, [r5, #76]
 579 0060 E86E     		ldr	r0, [r5, #108]
 580 0062 FFF7FEFF 		bl	dma_stream_en
 581              	.LVL71:
 582 0066 DDE7     		b	.L25
 583              	.LVL72:
 584              	.L34:
 168:drivers/bsp_f1xx_uart.c ****     }else{
 585              		.loc 1 168 0
 586 0068 024B     		ldr	r3, .L35+4
 587 006a 5A6D     		ldr	r2, [r3, #84]
 588 006c DA64     		str	r2, [r3, #76]
 589 006e E0E7     		b	.L27
 590              	.L36:
 591              		.align	2
 592              	.L35:
 593 0070 00440040 		.word	1073759232
 594 0074 00000000 		.word	.LANCHOR0
 595              	.LBE78:
 596              	.LBE79:
 597              		.cfi_endproc
 598              	.LFE74:
 600              		.section	.text.ComxSendData,"ax",%progbits
 601              		.align	1
 602              		.global	ComxSendData
 603              		.syntax unified
 604              		.thumb
 605              		.thumb_func
 606              		.fpu softvfp
 608              	ComxSendData:
 609              	.LFB75:
 196:drivers/bsp_f1xx_uart.c **** 
 197:drivers/bsp_f1xx_uart.c **** void ComxSendData(u8 comx, u8 *buf, u16 len)
 198:drivers/bsp_f1xx_uart.c **** {
 610              		.loc 1 198 0
 611              		.cfi_startproc
 612              		@ args = 0, pretend = 0, frame = 0
 613              		@ frame_needed = 0, uses_anonymous_args = 0
 614              	.LVL73:
 199:drivers/bsp_f1xx_uart.c ****     u16 i;
 200:drivers/bsp_f1xx_uart.c **** 
 201:drivers/bsp_f1xx_uart.c ****     _uart *com = &uartlist[comx - 1];
 202:drivers/bsp_f1xx_uart.c ****     if(len == 0 )
 615              		.loc 1 202 0
 616 0000 42B3     		cbz	r2, .L43
 198:drivers/bsp_f1xx_uart.c ****     u16 i;
 617              		.loc 1 198 0
 618 0002 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 619              	.LCFI4:
 620              		.cfi_def_cfa_offset 24
 621              		.cfi_offset 4, -24
ARM GAS  /var/folders/vc/p32jbmgs3k17njj5gy_2_k3w0000gn/T//ccQKnf9p.s 			page 16


 622              		.cfi_offset 5, -20
 623              		.cfi_offset 6, -16
 624              		.cfi_offset 7, -12
 625              		.cfi_offset 8, -8
 626              		.cfi_offset 14, -4
 627 0006 441E     		subs	r4, r0, #1
 628              	.LVL74:
 629 0008 9046     		mov	r8, r2
 203:drivers/bsp_f1xx_uart.c ****         return;
 204:drivers/bsp_f1xx_uart.c ****     if (!com->txch->CNDTR)
 630              		.loc 1 204 0
 631 000a 04EB0413 		add	r3, r4, r4, lsl #4
 632 000e 9A00     		lsls	r2, r3, #2
 633              	.LVL75:
 634 0010 114B     		ldr	r3, .L46
 635 0012 1344     		add	r3, r3, r2
 636 0014 DB6A     		ldr	r3, [r3, #44]
 637 0016 5B68     		ldr	r3, [r3, #4]
 638 0018 D3B9     		cbnz	r3, .L37
 205:drivers/bsp_f1xx_uart.c ****     {
 206:drivers/bsp_f1xx_uart.c ****         for (i = 0; i < len; i++)
 639              		.loc 1 206 0
 640 001a 0023     		movs	r3, #0
 641 001c 09E0     		b	.L39
 642              	.LVL76:
 643              	.L40:
 207:drivers/bsp_f1xx_uart.c ****             com->txbuf[i] = buf[i];
 644              		.loc 1 207 0 discriminator 3
 645 001e 04EB0410 		add	r0, r4, r4, lsl #4
 646 0022 8500     		lsls	r5, r0, #2
 647 0024 0C48     		ldr	r0, .L46
 648 0026 2844     		add	r0, r0, r5
 649 0028 4269     		ldr	r2, [r0, #20]
 650 002a C85C     		ldrb	r0, [r1, r3]	@ zero_extendqisi2
 651 002c D054     		strb	r0, [r2, r3]
 206:drivers/bsp_f1xx_uart.c ****             com->txbuf[i] = buf[i];
 652              		.loc 1 206 0 discriminator 3
 653 002e 0133     		adds	r3, r3, #1
 654              	.LVL77:
 655 0030 9BB2     		uxth	r3, r3
 656              	.LVL78:
 657              	.L39:
 206:drivers/bsp_f1xx_uart.c ****             com->txbuf[i] = buf[i];
 658              		.loc 1 206 0 is_stmt 0 discriminator 1
 659 0032 4345     		cmp	r3, r8
 660 0034 F3D3     		bcc	.L40
 208:drivers/bsp_f1xx_uart.c ****         dma_clear_flag(com->txch);
 661              		.loc 1 208 0 is_stmt 1
 662 0036 084E     		ldr	r6, .L46
 663 0038 2701     		lsls	r7, r4, #4
 664 003a 3B19     		adds	r3, r7, r4
 665              	.LVL79:
 666 003c 9D00     		lsls	r5, r3, #2
 667 003e 3544     		add	r5, r5, r6
 668 0040 E86A     		ldr	r0, [r5, #44]
 669 0042 FFF7FEFF 		bl	dma_clear_flag
 670              	.LVL80:
ARM GAS  /var/folders/vc/p32jbmgs3k17njj5gy_2_k3w0000gn/T//ccQKnf9p.s 			page 17


 209:drivers/bsp_f1xx_uart.c ****         dma_stream_en(com->txch,com->txbuf,len);
 671              		.loc 1 209 0
 672 0046 4246     		mov	r2, r8
 673 0048 6969     		ldr	r1, [r5, #20]
 674 004a E86A     		ldr	r0, [r5, #44]
 675 004c FFF7FEFF 		bl	dma_stream_en
 676              	.LVL81:
 677              	.L37:
 210:drivers/bsp_f1xx_uart.c ****     }
 211:drivers/bsp_f1xx_uart.c **** }
 678              		.loc 1 211 0
 679 0050 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 680              	.LVL82:
 681              	.L43:
 682              	.LCFI5:
 683              		.cfi_def_cfa_offset 0
 684              		.cfi_restore 4
 685              		.cfi_restore 5
 686              		.cfi_restore 6
 687              		.cfi_restore 7
 688              		.cfi_restore 8
 689              		.cfi_restore 14
 690 0054 7047     		bx	lr
 691              	.L47:
 692 0056 00BF     		.align	2
 693              	.L46:
 694 0058 00000000 		.word	.LANCHOR0
 695              		.cfi_endproc
 696              	.LFE75:
 698              		.section	.text.Com1SendData,"ax",%progbits
 699              		.align	1
 700              		.global	Com1SendData
 701              		.syntax unified
 702              		.thumb
 703              		.thumb_func
 704              		.fpu softvfp
 706              	Com1SendData:
 707              	.LFB79:
 212:drivers/bsp_f1xx_uart.c **** 
 213:drivers/bsp_f1xx_uart.c **** 
 214:drivers/bsp_f1xx_uart.c **** // 往PC传输,将串口收到的数据搬移到缓冲区中
 215:drivers/bsp_f1xx_uart.c **** void DMA1_Channel6_IRQHandler(void)
 216:drivers/bsp_f1xx_uart.c **** {
 217:drivers/bsp_f1xx_uart.c **** 	if ((DMA1->ISR) & BIT21) //缓冲区全满
 218:drivers/bsp_f1xx_uart.c **** 	{
 219:drivers/bsp_f1xx_uart.c **** 		DMA1->IFCR = 0x00F00000;
 220:drivers/bsp_f1xx_uart.c **** 		OnComDataRecved(COM2,0);
 221:drivers/bsp_f1xx_uart.c **** 	}
 222:drivers/bsp_f1xx_uart.c **** }
 223:drivers/bsp_f1xx_uart.c **** 
 224:drivers/bsp_f1xx_uart.c **** // 往PC传输,将串口收到的数据搬移到缓冲区中
 225:drivers/bsp_f1xx_uart.c **** void DMA1_Channel3_IRQHandler(void)
 226:drivers/bsp_f1xx_uart.c **** {
 227:drivers/bsp_f1xx_uart.c **** 	if ((DMA1->ISR) & BIT9) //缓冲区全满
 228:drivers/bsp_f1xx_uart.c **** 	{
 229:drivers/bsp_f1xx_uart.c **** 		DMA1->IFCR = 0x00000F00;
 230:drivers/bsp_f1xx_uart.c **** 		OnComDataRecved(COM3,0);
ARM GAS  /var/folders/vc/p32jbmgs3k17njj5gy_2_k3w0000gn/T//ccQKnf9p.s 			page 18


 231:drivers/bsp_f1xx_uart.c **** 	}
 232:drivers/bsp_f1xx_uart.c **** }
 233:drivers/bsp_f1xx_uart.c **** 
 234:drivers/bsp_f1xx_uart.c **** void ComxSetBaud(u8 comx,u32 baud)
 235:drivers/bsp_f1xx_uart.c **** {
 236:drivers/bsp_f1xx_uart.c ****     _uart *com = &uartlist[comx - 1];
 237:drivers/bsp_f1xx_uart.c ****     com->uartx->BRR = GetBaudDiv(com->pclk, baud); // 波特率设置
 238:drivers/bsp_f1xx_uart.c ****     delay_ms(10);
 239:drivers/bsp_f1xx_uart.c **** }
 240:drivers/bsp_f1xx_uart.c **** 
 241:drivers/bsp_f1xx_uart.c **** void Com1SendData(u8 *dat,u16 len)
 242:drivers/bsp_f1xx_uart.c **** {
 708              		.loc 1 242 0
 709              		.cfi_startproc
 710              		@ args = 0, pretend = 0, frame = 0
 711              		@ frame_needed = 0, uses_anonymous_args = 0
 712              	.LVL83:
 713 0000 08B5     		push	{r3, lr}
 714              	.LCFI6:
 715              		.cfi_def_cfa_offset 8
 716              		.cfi_offset 3, -8
 717              		.cfi_offset 14, -4
 243:drivers/bsp_f1xx_uart.c ****     ComxSendData(COM1,dat,len);
 718              		.loc 1 243 0
 719 0002 0A46     		mov	r2, r1
 720 0004 0146     		mov	r1, r0
 721              	.LVL84:
 722 0006 0120     		movs	r0, #1
 723              	.LVL85:
 724 0008 FFF7FEFF 		bl	ComxSendData
 725              	.LVL86:
 244:drivers/bsp_f1xx_uart.c **** }
 726              		.loc 1 244 0
 727 000c 08BD     		pop	{r3, pc}
 728              		.cfi_endproc
 729              	.LFE79:
 731              		.section	.text.Com2SendData,"ax",%progbits
 732              		.align	1
 733              		.global	Com2SendData
 734              		.syntax unified
 735              		.thumb
 736              		.thumb_func
 737              		.fpu softvfp
 739              	Com2SendData:
 740              	.LFB80:
 245:drivers/bsp_f1xx_uart.c **** 
 246:drivers/bsp_f1xx_uart.c **** void Com2SendData(u8 *dat,u16 len)
 247:drivers/bsp_f1xx_uart.c **** {
 741              		.loc 1 247 0
 742              		.cfi_startproc
 743              		@ args = 0, pretend = 0, frame = 0
 744              		@ frame_needed = 0, uses_anonymous_args = 0
 745              	.LVL87:
 746 0000 08B5     		push	{r3, lr}
 747              	.LCFI7:
 748              		.cfi_def_cfa_offset 8
 749              		.cfi_offset 3, -8
ARM GAS  /var/folders/vc/p32jbmgs3k17njj5gy_2_k3w0000gn/T//ccQKnf9p.s 			page 19


 750              		.cfi_offset 14, -4
 248:drivers/bsp_f1xx_uart.c ****     ComxSendData(COM2,dat,len);
 751              		.loc 1 248 0
 752 0002 0A46     		mov	r2, r1
 753 0004 0146     		mov	r1, r0
 754              	.LVL88:
 755 0006 0220     		movs	r0, #2
 756              	.LVL89:
 757 0008 FFF7FEFF 		bl	ComxSendData
 758              	.LVL90:
 249:drivers/bsp_f1xx_uart.c **** }
 759              		.loc 1 249 0
 760 000c 08BD     		pop	{r3, pc}
 761              		.cfi_endproc
 762              	.LFE80:
 764              		.section	.text.DMA1_Channel6_IRQHandler,"ax",%progbits
 765              		.align	1
 766              		.global	DMA1_Channel6_IRQHandler
 767              		.syntax unified
 768              		.thumb
 769              		.thumb_func
 770              		.fpu softvfp
 772              	DMA1_Channel6_IRQHandler:
 773              	.LFB76:
 216:drivers/bsp_f1xx_uart.c **** 	if ((DMA1->ISR) & BIT21) //缓冲区全满
 774              		.loc 1 216 0
 775              		.cfi_startproc
 776              		@ args = 0, pretend = 0, frame = 0
 777              		@ frame_needed = 0, uses_anonymous_args = 0
 217:drivers/bsp_f1xx_uart.c **** 	{
 778              		.loc 1 217 0
 779 0000 1A4B     		ldr	r3, .L64
 780 0002 1B68     		ldr	r3, [r3]
 781 0004 13F4001F 		tst	r3, #2097152
 782 0008 00D1     		bne	.L61
 783 000a 7047     		bx	lr
 784              	.L61:
 216:drivers/bsp_f1xx_uart.c **** 	if ((DMA1->ISR) & BIT21) //缓冲区全满
 785              		.loc 1 216 0
 786 000c 70B5     		push	{r4, r5, r6, lr}
 787              	.LCFI8:
 788              		.cfi_def_cfa_offset 16
 789              		.cfi_offset 4, -16
 790              		.cfi_offset 5, -12
 791              		.cfi_offset 6, -8
 792              		.cfi_offset 14, -4
 219:drivers/bsp_f1xx_uart.c **** 		OnComDataRecved(COM2,0);
 793              		.loc 1 219 0
 794 000e 174B     		ldr	r3, .L64
 795 0010 4FF47002 		mov	r2, #15728640
 796 0014 5A60     		str	r2, [r3, #4]
 797              	.LVL91:
 798              	.LBB82:
 799              	.LBB83:
 158:drivers/bsp_f1xx_uart.c ****     if(recvLen==0)
 800              		.loc 1 158 0
 801 0016 164B     		ldr	r3, .L64+4
ARM GAS  /var/folders/vc/p32jbmgs3k17njj5gy_2_k3w0000gn/T//ccQKnf9p.s 			page 20


 802 0018 B3F84A60 		ldrh	r6, [r3, #74]
 803              	.LVL92:
 159:drivers/bsp_f1xx_uart.c ****     {
 804              		.loc 1 159 0
 805 001c B6B1     		cbz	r6, .L62
 806              	.L54:
 165:drivers/bsp_f1xx_uart.c ****     if(recvCom->curbuf == recvCom->rxbuf1)
 807              		.loc 1 165 0
 808 001e 144B     		ldr	r3, .L64+4
 809 0020 DD6C     		ldr	r5, [r3, #76]
 810              	.LVL93:
 166:drivers/bsp_f1xx_uart.c ****     {
 811              		.loc 1 166 0
 812 0022 1B6D     		ldr	r3, [r3, #80]
 813 0024 9D42     		cmp	r5, r3
 814 0026 1CD0     		beq	.L63
 170:drivers/bsp_f1xx_uart.c ****     }
 815              		.loc 1 170 0
 816 0028 114A     		ldr	r2, .L64+4
 817 002a D364     		str	r3, [r2, #76]
 818              	.L56:
 172:drivers/bsp_f1xx_uart.c ****     dma_stream_en(recvCom->rxch,recvCom->curbuf,recvCom->rxbufLen);
 819              		.loc 1 172 0
 820 002c 104C     		ldr	r4, .L64+4
 821 002e E06E     		ldr	r0, [r4, #108]
 822 0030 FFF7FEFF 		bl	dma_clear_flag
 823              	.LVL94:
 173:drivers/bsp_f1xx_uart.c ****     recvCom->onDataRecved(p, recvLen);
 824              		.loc 1 173 0
 825 0034 B4F84A20 		ldrh	r2, [r4, #74]
 826 0038 E16C     		ldr	r1, [r4, #76]
 827 003a E06E     		ldr	r0, [r4, #108]
 828 003c FFF7FEFF 		bl	dma_stream_en
 829              	.LVL95:
 174:drivers/bsp_f1xx_uart.c **** }
 830              		.loc 1 174 0
 831 0040 D4F88430 		ldr	r3, [r4, #132]
 832 0044 3146     		mov	r1, r6
 833 0046 2846     		mov	r0, r5
 834 0048 9847     		blx	r3
 835              	.LVL96:
 836              	.LBE83:
 837              	.LBE82:
 222:drivers/bsp_f1xx_uart.c **** 
 838              		.loc 1 222 0
 839 004a 70BD     		pop	{r4, r5, r6, pc}
 840              	.LVL97:
 841              	.L62:
 842              	.LBB85:
 843              	.LBB84:
 161:drivers/bsp_f1xx_uart.c ****         dma_stream_en(recvCom->rxch,recvCom->curbuf,recvCom->rxbufLen);
 844              		.loc 1 161 0
 845 004c 1C46     		mov	r4, r3
 846 004e D86E     		ldr	r0, [r3, #108]
 847 0050 FFF7FEFF 		bl	dma_clear_flag
 848              	.LVL98:
 162:drivers/bsp_f1xx_uart.c ****     }
ARM GAS  /var/folders/vc/p32jbmgs3k17njj5gy_2_k3w0000gn/T//ccQKnf9p.s 			page 21


 849              		.loc 1 162 0
 850 0054 B4F84A20 		ldrh	r2, [r4, #74]
 851 0058 E16C     		ldr	r1, [r4, #76]
 852 005a E06E     		ldr	r0, [r4, #108]
 853 005c FFF7FEFF 		bl	dma_stream_en
 854              	.LVL99:
 855 0060 DDE7     		b	.L54
 856              	.LVL100:
 857              	.L63:
 168:drivers/bsp_f1xx_uart.c ****     }else{
 858              		.loc 1 168 0
 859 0062 034B     		ldr	r3, .L64+4
 860 0064 5A6D     		ldr	r2, [r3, #84]
 861 0066 DA64     		str	r2, [r3, #76]
 862 0068 E0E7     		b	.L56
 863              	.L65:
 864 006a 00BF     		.align	2
 865              	.L64:
 866 006c 00000240 		.word	1073872896
 867 0070 00000000 		.word	.LANCHOR0
 868              	.LBE84:
 869              	.LBE85:
 870              		.cfi_endproc
 871              	.LFE76:
 873              		.section	.text.DMA1_Channel3_IRQHandler,"ax",%progbits
 874              		.align	1
 875              		.global	DMA1_Channel3_IRQHandler
 876              		.syntax unified
 877              		.thumb
 878              		.thumb_func
 879              		.fpu softvfp
 881              	DMA1_Channel3_IRQHandler:
 882              	.LFB77:
 226:drivers/bsp_f1xx_uart.c **** 	if ((DMA1->ISR) & BIT9) //缓冲区全满
 883              		.loc 1 226 0
 884              		.cfi_startproc
 885              		@ args = 0, pretend = 0, frame = 0
 886              		@ frame_needed = 0, uses_anonymous_args = 0
 227:drivers/bsp_f1xx_uart.c **** 	{
 887              		.loc 1 227 0
 888 0000 1F4B     		ldr	r3, .L78
 889 0002 1B68     		ldr	r3, [r3]
 890 0004 13F4007F 		tst	r3, #512
 891 0008 00D1     		bne	.L75
 892 000a 7047     		bx	lr
 893              	.L75:
 226:drivers/bsp_f1xx_uart.c **** 	if ((DMA1->ISR) & BIT9) //缓冲区全满
 894              		.loc 1 226 0
 895 000c 70B5     		push	{r4, r5, r6, lr}
 896              	.LCFI9:
 897              		.cfi_def_cfa_offset 16
 898              		.cfi_offset 4, -16
 899              		.cfi_offset 5, -12
 900              		.cfi_offset 6, -8
 901              		.cfi_offset 14, -4
 229:drivers/bsp_f1xx_uart.c **** 		OnComDataRecved(COM3,0);
 902              		.loc 1 229 0
ARM GAS  /var/folders/vc/p32jbmgs3k17njj5gy_2_k3w0000gn/T//ccQKnf9p.s 			page 22


 903 000e 1C4B     		ldr	r3, .L78
 904 0010 4FF47062 		mov	r2, #3840
 905 0014 5A60     		str	r2, [r3, #4]
 906              	.LVL101:
 907              	.LBB88:
 908              	.LBB89:
 158:drivers/bsp_f1xx_uart.c ****     if(recvLen==0)
 909              		.loc 1 158 0
 910 0016 1B4B     		ldr	r3, .L78+4
 911 0018 B3F88E60 		ldrh	r6, [r3, #142]
 912              	.LVL102:
 159:drivers/bsp_f1xx_uart.c ****     {
 913              		.loc 1 159 0
 914 001c E6B1     		cbz	r6, .L76
 915              	.L68:
 165:drivers/bsp_f1xx_uart.c ****     if(recvCom->curbuf == recvCom->rxbuf1)
 916              		.loc 1 165 0
 917 001e 194B     		ldr	r3, .L78+4
 918 0020 D3F89050 		ldr	r5, [r3, #144]
 919              	.LVL103:
 166:drivers/bsp_f1xx_uart.c ****     {
 920              		.loc 1 166 0
 921 0024 D3F89430 		ldr	r3, [r3, #148]
 922 0028 9D42     		cmp	r5, r3
 923 002a 23D0     		beq	.L77
 170:drivers/bsp_f1xx_uart.c ****     }
 924              		.loc 1 170 0
 925 002c 154A     		ldr	r2, .L78+4
 926 002e C2F89030 		str	r3, [r2, #144]
 927              	.L70:
 172:drivers/bsp_f1xx_uart.c ****     dma_stream_en(recvCom->rxch,recvCom->curbuf,recvCom->rxbufLen);
 928              		.loc 1 172 0
 929 0032 144C     		ldr	r4, .L78+4
 930 0034 D4F8B000 		ldr	r0, [r4, #176]
 931 0038 FFF7FEFF 		bl	dma_clear_flag
 932              	.LVL104:
 173:drivers/bsp_f1xx_uart.c ****     recvCom->onDataRecved(p, recvLen);
 933              		.loc 1 173 0
 934 003c B4F88E20 		ldrh	r2, [r4, #142]
 935 0040 D4F89010 		ldr	r1, [r4, #144]
 936 0044 D4F8B000 		ldr	r0, [r4, #176]
 937 0048 FFF7FEFF 		bl	dma_stream_en
 938              	.LVL105:
 174:drivers/bsp_f1xx_uart.c **** }
 939              		.loc 1 174 0
 940 004c D4F8C830 		ldr	r3, [r4, #200]
 941 0050 3146     		mov	r1, r6
 942 0052 2846     		mov	r0, r5
 943 0054 9847     		blx	r3
 944              	.LVL106:
 945              	.LBE89:
 946              	.LBE88:
 232:drivers/bsp_f1xx_uart.c **** 
 947              		.loc 1 232 0
 948 0056 70BD     		pop	{r4, r5, r6, pc}
 949              	.LVL107:
 950              	.L76:
ARM GAS  /var/folders/vc/p32jbmgs3k17njj5gy_2_k3w0000gn/T//ccQKnf9p.s 			page 23


 951              	.LBB91:
 952              	.LBB90:
 161:drivers/bsp_f1xx_uart.c ****         dma_stream_en(recvCom->rxch,recvCom->curbuf,recvCom->rxbufLen);
 953              		.loc 1 161 0
 954 0058 1C46     		mov	r4, r3
 955 005a D3F8B000 		ldr	r0, [r3, #176]
 956 005e FFF7FEFF 		bl	dma_clear_flag
 957              	.LVL108:
 162:drivers/bsp_f1xx_uart.c ****     }
 958              		.loc 1 162 0
 959 0062 B4F88E20 		ldrh	r2, [r4, #142]
 960 0066 D4F89010 		ldr	r1, [r4, #144]
 961 006a D4F8B000 		ldr	r0, [r4, #176]
 962 006e FFF7FEFF 		bl	dma_stream_en
 963              	.LVL109:
 964 0072 D4E7     		b	.L68
 965              	.LVL110:
 966              	.L77:
 168:drivers/bsp_f1xx_uart.c ****     }else{
 967              		.loc 1 168 0
 968 0074 034B     		ldr	r3, .L78+4
 969 0076 D3F89820 		ldr	r2, [r3, #152]
 970 007a C3F89020 		str	r2, [r3, #144]
 971 007e D8E7     		b	.L70
 972              	.L79:
 973              		.align	2
 974              	.L78:
 975 0080 00000240 		.word	1073872896
 976 0084 00000000 		.word	.LANCHOR0
 977              	.LBE90:
 978              	.LBE91:
 979              		.cfi_endproc
 980              	.LFE77:
 982              		.section	.text.ComxSetBaud,"ax",%progbits
 983              		.align	1
 984              		.global	ComxSetBaud
 985              		.syntax unified
 986              		.thumb
 987              		.thumb_func
 988              		.fpu softvfp
 990              	ComxSetBaud:
 991              	.LFB78:
 235:drivers/bsp_f1xx_uart.c ****     _uart *com = &uartlist[comx - 1];
 992              		.loc 1 235 0
 993              		.cfi_startproc
 994              		@ args = 0, pretend = 0, frame = 0
 995              		@ frame_needed = 0, uses_anonymous_args = 0
 996              	.LVL111:
 997 0000 70B5     		push	{r4, r5, r6, lr}
 998              	.LCFI10:
 999              		.cfi_def_cfa_offset 16
 1000              		.cfi_offset 4, -16
 1001              		.cfi_offset 5, -12
 1002              		.cfi_offset 6, -8
 1003              		.cfi_offset 14, -4
 1004 0002 0C46     		mov	r4, r1
 236:drivers/bsp_f1xx_uart.c ****     com->uartx->BRR = GetBaudDiv(com->pclk, baud); // 波特率设置
ARM GAS  /var/folders/vc/p32jbmgs3k17njj5gy_2_k3w0000gn/T//ccQKnf9p.s 			page 24


 1005              		.loc 1 236 0
 1006 0004 0138     		subs	r0, r0, #1
 1007              	.LVL112:
 237:drivers/bsp_f1xx_uart.c ****     delay_ms(10);
 1008              		.loc 1 237 0
 1009 0006 1649     		ldr	r1, .L82
 1010              	.LVL113:
 1011 0008 0301     		lsls	r3, r0, #4
 1012 000a 1D18     		adds	r5, r3, r0
 1013 000c AA00     		lsls	r2, r5, #2
 1014 000e 1346     		mov	r3, r2
 1015 0010 0B44     		add	r3, r3, r1
 1016 0012 1D6A     		ldr	r5, [r3, #32]
 1017              	.LVL114:
 1018              	.LBB92:
 1019              	.LBB93:
  92:drivers/bsp_f1xx_uart.c ****     mantissa = temp;		      //得到整数部分
 1020              		.loc 1 92 0
 1021 0014 8858     		ldr	r0, [r1, r2]
 1022              	.LVL115:
 1023 0016 FFF7FEFF 		bl	__aeabi_ui2f
 1024              	.LVL116:
 1025 001a 0646     		mov	r6, r0
 1026 001c 2001     		lsls	r0, r4, #4
 1027 001e FFF7FEFF 		bl	__aeabi_ui2f
 1028              	.LVL117:
 1029 0022 0146     		mov	r1, r0
 1030 0024 3046     		mov	r0, r6
 1031 0026 FFF7FEFF 		bl	__aeabi_fdiv
 1032              	.LVL118:
 1033 002a 0646     		mov	r6, r0
 1034              	.LVL119:
  93:drivers/bsp_f1xx_uart.c ****     fraction = (temp - mantissa) * 16;    //得到小数部分
 1035              		.loc 1 93 0
 1036 002c FFF7FEFF 		bl	__aeabi_f2uiz
 1037              	.LVL120:
 1038 0030 84B2     		uxth	r4, r0
 1039              	.LVL121:
  94:drivers/bsp_f1xx_uart.c ****     mantissa <<= 4;
 1040              		.loc 1 94 0
 1041 0032 2046     		mov	r0, r4
 1042 0034 FFF7FEFF 		bl	__aeabi_i2f
 1043              	.LVL122:
 1044 0038 0146     		mov	r1, r0
 1045 003a 3046     		mov	r0, r6
 1046 003c FFF7FEFF 		bl	__aeabi_fsub
 1047              	.LVL123:
 1048 0040 4FF08341 		mov	r1, #1098907648
 1049 0044 FFF7FEFF 		bl	__aeabi_fmul
 1050              	.LVL124:
 1051 0048 FFF7FEFF 		bl	__aeabi_f2uiz
 1052              	.LVL125:
 1053 004c 80B2     		uxth	r0, r0
 1054              	.LVL126:
  95:drivers/bsp_f1xx_uart.c ****     mantissa += fraction;
 1055              		.loc 1 95 0
 1056 004e 2401     		lsls	r4, r4, #4
ARM GAS  /var/folders/vc/p32jbmgs3k17njj5gy_2_k3w0000gn/T//ccQKnf9p.s 			page 25


 1057              	.LVL127:
 1058 0050 A4B2     		uxth	r4, r4
 1059              	.LVL128:
  96:drivers/bsp_f1xx_uart.c ****     return mantissa;
 1060              		.loc 1 96 0
 1061 0052 0444     		add	r4, r4, r0
 1062              	.LVL129:
 1063 0054 A4B2     		uxth	r4, r4
 1064              	.LVL130:
 1065              	.LBE93:
 1066              	.LBE92:
 237:drivers/bsp_f1xx_uart.c ****     delay_ms(10);
 1067              		.loc 1 237 0
 1068 0056 AC60     		str	r4, [r5, #8]
 238:drivers/bsp_f1xx_uart.c **** }
 1069              		.loc 1 238 0
 1070 0058 0A20     		movs	r0, #10
 1071 005a FFF7FEFF 		bl	delay_ms
 1072              	.LVL131:
 239:drivers/bsp_f1xx_uart.c **** 
 1073              		.loc 1 239 0
 1074 005e 70BD     		pop	{r4, r5, r6, pc}
 1075              	.L83:
 1076              		.align	2
 1077              	.L82:
 1078 0060 00000000 		.word	.LANCHOR0
 1079              		.cfi_endproc
 1080              	.LFE78:
 1082              		.global	uartlist
 1083              		.global	SendFuncs
 1084              		.section	.data.SendFuncs,"aw",%progbits
 1085              		.align	2
 1086              		.set	.LANCHOR1,. + 0
 1089              	SendFuncs:
 1090 0000 00000000 		.word	Com1SendData
 1091 0004 00000000 		.word	Com2SendData
 1092              		.section	.data.uartlist,"aw",%progbits
 1093              		.align	2
 1094              		.set	.LANCHOR0,. + 0
 1097              	uartlist:
 1098 0000 00A24A04 		.word	72000000
 1099 0004 25       		.byte	37
 1100 0005 00000000 		.space	19
 1100      00000000 
 1100      00000000 
 1100      00000000 
 1100      000000
 1101 0018 18100240 		.word	1073877016
 1102 001c 00400000 		.word	16384
 1103 0020 00380140 		.word	1073821696
 1104 0024 0F       		.byte	15
 1105 0025 0E       		.byte	14
 1106 0026 0000     		.space	2
 1107 0028 58000240 		.word	1073872984
 1108 002c 44000240 		.word	1073872964
 1109 0030 00080140 		.word	1073809408
 1110 0034 09       		.byte	9
ARM GAS  /var/folders/vc/p32jbmgs3k17njj5gy_2_k3w0000gn/T//ccQKnf9p.s 			page 26


 1111 0035 0B       		.byte	11
 1112 0036 0000     		.space	2
 1113 0038 00080140 		.word	1073809408
 1114 003c 0A       		.byte	10
 1115 003d 04       		.byte	4
 1116 003e 0000     		.space	2
 1117 0040 00000000 		.space	4
 1118 0044 00512502 		.word	36000000
 1119 0048 26       		.byte	38
 1120 0049 00000000 		.space	19
 1120      00000000 
 1120      00000000 
 1120      00000000 
 1120      000000
 1121 005c 1C100240 		.word	1073877020
 1122 0060 00000200 		.word	131072
 1123 0064 00440040 		.word	1073759232
 1124 0068 10       		.byte	16
 1125 0069 11       		.byte	17
 1126 006a 0000     		.space	2
 1127 006c 6C000240 		.word	1073873004
 1128 0070 80000240 		.word	1073873024
 1129 0074 00080140 		.word	1073809408
 1130 0078 02       		.byte	2
 1131 0079 0B       		.byte	11
 1132 007a 0000     		.space	2
 1133 007c 00080140 		.word	1073809408
 1134 0080 03       		.byte	3
 1135 0081 04       		.byte	4
 1136 0082 0000     		.space	2
 1137 0084 00000000 		.space	4
 1138 0088 00512502 		.word	36000000
 1139 008c 27       		.byte	39
 1140 008d 00000000 		.space	19
 1140      00000000 
 1140      00000000 
 1140      00000000 
 1140      000000
 1141 00a0 1C100240 		.word	1073877020
 1142 00a4 00000400 		.word	262144
 1143 00a8 00480040 		.word	1073760256
 1144 00ac 0D       		.byte	13
 1145 00ad 0C       		.byte	12
 1146 00ae 0000     		.space	2
 1147 00b0 30000240 		.word	1073872944
 1148 00b4 1C000240 		.word	1073872924
 1149 00b8 000C0140 		.word	1073810432
 1150 00bc 0A       		.byte	10
 1151 00bd 0B       		.byte	11
 1152 00be 0000     		.space	2
 1153 00c0 000C0140 		.word	1073810432
 1154 00c4 0B       		.byte	11
 1155 00c5 04       		.byte	4
 1156 00c6 0000     		.space	2
 1157 00c8 00000000 		.space	4
 1158              		.text
 1159              	.Letext0:
ARM GAS  /var/folders/vc/p32jbmgs3k17njj5gy_2_k3w0000gn/T//ccQKnf9p.s 			page 27


 1160              		.file 2 "/Users/zy/Desktop/Tools/gcc-arm-none-eabi-9-2019-q4-major/arm-none-eabi/include/machine/_
 1161              		.file 3 "/Users/zy/Desktop/Tools/gcc-arm-none-eabi-9-2019-q4-major/arm-none-eabi/include/sys/_stdi
 1162              		.file 4 "Inc/stm32f103xe.h"
 1163              		.file 5 "/Users/zy/Desktop/Tools/gcc-arm-none-eabi-9-2019-q4-major/arm-none-eabi/include/sys/lock.
 1164              		.file 6 "/Users/zy/Desktop/Tools/gcc-arm-none-eabi-9-2019-q4-major/arm-none-eabi/include/sys/_type
 1165              		.file 7 "/Users/zy/Desktop/Tools/gcc-arm-none-eabi-7-2017-q4-major/lib/gcc/arm-none-eabi/7.2.1/inc
 1166              		.file 8 "/Users/zy/Desktop/Tools/gcc-arm-none-eabi-9-2019-q4-major/arm-none-eabi/include/sys/reent
 1167              		.file 9 "Inc/core_cm3.h"
 1168              		.file 10 "startup/inc/sys.h"
 1169              		.file 11 "tools/inc/malloc.h"
 1170              		.file 12 "tools/inc/tskmanager.h"
 1171              		.file 13 "drivers/inc/bsp_f1xx_io.h"
 1172              		.file 14 "drivers/inc/datautil.h"
 1173              		.file 15 "drivers/inc/bsp_f1xx_uart.h"
 1174              		.file 16 "drivers/inc/bsp_f1xx_dma.h"
ARM GAS  /var/folders/vc/p32jbmgs3k17njj5gy_2_k3w0000gn/T//ccQKnf9p.s 			page 28


DEFINED SYMBOLS
                            *ABS*:0000000000000000 bsp_f1xx_uart.c
/var/folders/vc/p32jbmgs3k17njj5gy_2_k3w0000gn/T//ccQKnf9p.s:22     .text.bsp_UartInit:0000000000000000 $t
/var/folders/vc/p32jbmgs3k17njj5gy_2_k3w0000gn/T//ccQKnf9p.s:29     .text.bsp_UartInit:0000000000000000 bsp_UartInit
/var/folders/vc/p32jbmgs3k17njj5gy_2_k3w0000gn/T//ccQKnf9p.s:286    .text.bsp_UartInit:000000000000015c $d
/var/folders/vc/p32jbmgs3k17njj5gy_2_k3w0000gn/T//ccQKnf9p.s:292    .text.bsp_UartClose:0000000000000000 $t
/var/folders/vc/p32jbmgs3k17njj5gy_2_k3w0000gn/T//ccQKnf9p.s:299    .text.bsp_UartClose:0000000000000000 bsp_UartClose
/var/folders/vc/p32jbmgs3k17njj5gy_2_k3w0000gn/T//ccQKnf9p.s:364    .text.bsp_UartClose:0000000000000030 $d
/var/folders/vc/p32jbmgs3k17njj5gy_2_k3w0000gn/T//ccQKnf9p.s:369    .text.USART1_IRQHandler:0000000000000000 $t
/var/folders/vc/p32jbmgs3k17njj5gy_2_k3w0000gn/T//ccQKnf9p.s:376    .text.USART1_IRQHandler:0000000000000000 USART1_IRQHandler
/var/folders/vc/p32jbmgs3k17njj5gy_2_k3w0000gn/T//ccQKnf9p.s:477    .text.USART1_IRQHandler:0000000000000068 $d
/var/folders/vc/p32jbmgs3k17njj5gy_2_k3w0000gn/T//ccQKnf9p.s:485    .text.USART2_IRQHandler:0000000000000000 $t
/var/folders/vc/p32jbmgs3k17njj5gy_2_k3w0000gn/T//ccQKnf9p.s:492    .text.USART2_IRQHandler:0000000000000000 USART2_IRQHandler
/var/folders/vc/p32jbmgs3k17njj5gy_2_k3w0000gn/T//ccQKnf9p.s:593    .text.USART2_IRQHandler:0000000000000070 $d
/var/folders/vc/p32jbmgs3k17njj5gy_2_k3w0000gn/T//ccQKnf9p.s:601    .text.ComxSendData:0000000000000000 $t
/var/folders/vc/p32jbmgs3k17njj5gy_2_k3w0000gn/T//ccQKnf9p.s:608    .text.ComxSendData:0000000000000000 ComxSendData
/var/folders/vc/p32jbmgs3k17njj5gy_2_k3w0000gn/T//ccQKnf9p.s:694    .text.ComxSendData:0000000000000058 $d
/var/folders/vc/p32jbmgs3k17njj5gy_2_k3w0000gn/T//ccQKnf9p.s:699    .text.Com1SendData:0000000000000000 $t
/var/folders/vc/p32jbmgs3k17njj5gy_2_k3w0000gn/T//ccQKnf9p.s:706    .text.Com1SendData:0000000000000000 Com1SendData
/var/folders/vc/p32jbmgs3k17njj5gy_2_k3w0000gn/T//ccQKnf9p.s:732    .text.Com2SendData:0000000000000000 $t
/var/folders/vc/p32jbmgs3k17njj5gy_2_k3w0000gn/T//ccQKnf9p.s:739    .text.Com2SendData:0000000000000000 Com2SendData
/var/folders/vc/p32jbmgs3k17njj5gy_2_k3w0000gn/T//ccQKnf9p.s:765    .text.DMA1_Channel6_IRQHandler:0000000000000000 $t
/var/folders/vc/p32jbmgs3k17njj5gy_2_k3w0000gn/T//ccQKnf9p.s:772    .text.DMA1_Channel6_IRQHandler:0000000000000000 DMA1_Channel6_IRQHandler
/var/folders/vc/p32jbmgs3k17njj5gy_2_k3w0000gn/T//ccQKnf9p.s:866    .text.DMA1_Channel6_IRQHandler:000000000000006c $d
/var/folders/vc/p32jbmgs3k17njj5gy_2_k3w0000gn/T//ccQKnf9p.s:874    .text.DMA1_Channel3_IRQHandler:0000000000000000 $t
/var/folders/vc/p32jbmgs3k17njj5gy_2_k3w0000gn/T//ccQKnf9p.s:881    .text.DMA1_Channel3_IRQHandler:0000000000000000 DMA1_Channel3_IRQHandler
/var/folders/vc/p32jbmgs3k17njj5gy_2_k3w0000gn/T//ccQKnf9p.s:975    .text.DMA1_Channel3_IRQHandler:0000000000000080 $d
/var/folders/vc/p32jbmgs3k17njj5gy_2_k3w0000gn/T//ccQKnf9p.s:983    .text.ComxSetBaud:0000000000000000 $t
/var/folders/vc/p32jbmgs3k17njj5gy_2_k3w0000gn/T//ccQKnf9p.s:990    .text.ComxSetBaud:0000000000000000 ComxSetBaud
/var/folders/vc/p32jbmgs3k17njj5gy_2_k3w0000gn/T//ccQKnf9p.s:1078   .text.ComxSetBaud:0000000000000060 $d
/var/folders/vc/p32jbmgs3k17njj5gy_2_k3w0000gn/T//ccQKnf9p.s:1097   .data.uartlist:0000000000000000 uartlist
/var/folders/vc/p32jbmgs3k17njj5gy_2_k3w0000gn/T//ccQKnf9p.s:1089   .data.SendFuncs:0000000000000000 SendFuncs
/var/folders/vc/p32jbmgs3k17njj5gy_2_k3w0000gn/T//ccQKnf9p.s:1085   .data.SendFuncs:0000000000000000 $d
/var/folders/vc/p32jbmgs3k17njj5gy_2_k3w0000gn/T//ccQKnf9p.s:1093   .data.uartlist:0000000000000000 $d

UNDEFINED SYMBOLS
__aeabi_ui2f
__aeabi_fdiv
__aeabi_f2uiz
__aeabi_i2f
__aeabi_fsub
__aeabi_fmul
myfree
mymalloc
dmainit
bsp_IoInit
delay_ms
MY_NVIC_Init
dma_stream_en
dma_clear_flag
